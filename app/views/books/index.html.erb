<!-- Hero Section -->
<section class="hero">
   <div class="hero-content">
      <% if user_signed_in? %>
         <h1>Welcome to Book Tracker, <%= current_user.name %></h1>
         <p>Track all the books you've read and keep your collection organized!</p>
         <%= link_to "Add New Book ‚äï", new_book_path, class: "add-book-btn" %>
      <% else %>
         <h1>Welcome to Book Tracker</h1>
         <p>Sign in to track all the books you've read and keep your collection organized!</p>
         <%= link_to "Login", new_user_session_path, class: "nav-link button" %>
         <%= link_to "Sign Up", new_user_registration_path, class: "nav-link button" %>
      <% end %>
   </div>
</section>

<% if user_signed_in? %>
   <%# Top Genre with emoji %>
   <% emoji = case @top_genre
      when "Fantasy" then "üè∞üó°Ô∏èüèûÔ∏è"
      when "Scifi" then "üõ∞Ô∏èüß¨ü™ê"
      when "Historical Fiction" then "üè∫üìú"
      when "Mystery" then "üïµÔ∏è‚Äç‚ôÇÔ∏èüîç"
		when "Thriller" then "ü©∏üíÄüî™ "
      when "Romance" then "‚ù§Ô∏èüíå"
      when "Horror" then "üëªü©∏"
      when "Biography" then "üë§üìñ"
      when "Self-Help" then "üí°üìù"
      else "üìò"
   end %>


   <!-- Genre Filter -->
   <h3>Sort Books by Genre:</h3>
   <div class="genre-links">
      <%= link_to "All", books_path(genre: nil), class: ["genre-button2", ("active" unless params[:genre].present?)].compact.join(" ") %>

      <% @genres.each do |g| %>
         <%= link_to g, books_path(genre: g), class: ["genre-button2", ("active" if params[:genre] == g)].compact.join(" ") %>
      <% end %>
   </div>

   <!-- Rating Filter -->
   <h3>Sort Books by Rating:</h3>
   <div class="genre-links">
      <%= link_to "All", books_path(rating: nil), class: ["genre-button2", ("active" unless params[:rating].present?)].compact.join(" ") %>

      <% ["1 ‚≠ê", "2 ‚≠ê", "3 ‚≠ê", "4 ‚≠ê", "5 ‚≠ê"].each do |label| %>
         <% num = label.split.first %>
         <%= link_to label, books_path(rating: num), class: ["genre-button2", ("active" if params[:rating] == num)].compact.join(" ") %>
      <% end %>
   </div>

   <!-- Filter Message -->
   <% if params[:genre].present? %>
      <p>Showing only <strong><%= params[:genre] %></strong> books:</p>
   <% elsif params[:rating].present? %>
      <p>Showing only <strong><%= params[:rating] %> ‚≠ê</strong> books:</p>
   <% end %>


	<div class="top-genre">
      <p>
         üìö Most-Read Genre:
         <strong>
            <%= link_to books_path(genre: @top_genre), class: "genre-button" do %>
               <%= @top_genre %> <%= emoji %>
            <% end %>
         </strong>
      </p>
   </div>

   <div class="books-sections">
      <!-- Currently Reading -->
      <section class="book-sections">
         <h1>üìñ Currently Reading: <%= @current_read.count %></h1>
         <div class="scroll-box">
            <% if @current_read.any? %>
               <% @current_read.each do |book| %>
                  <%= render 'book_card', book: book, section_prefix: 'current-read' %>
               <% end %>
            <% else %>
               <p>You are not currently reading any books...</p>
            <% end %>
         </div>
      </section>

      <!-- Finished Books -->
      <section class="book-sections">
         <h1>‚úÖ Finished Books: <%= @finished_books.count %></h1>
         <div class="scroll-box">
            <% if @finished_books.any? %>
               <% @finished_books.each do |book| %>
                  <%= render 'book_card', book: book, section_prefix: 'finished' %>
               <% end %>
            <% else %>
               <p>You have not finished any books yet...</p>
            <% end %>
         </div>
      </section>

      <!-- Not Started Books -->
      <section class="book-sections">
         <h1>üìö Not Started: <%= @not_started.count %></h1>
         <div class="scroll-box">
            <% if @not_started.any? %>
               <% @not_started.each do |book| %>
                  <%= render 'book_card', book: book, section_prefix: 'not-started' %>
               <% end %>
            <% else %>
               <p>Books you haven't started yet</p>
            <% end %>
         </div>
      </section>

      <!-- Wishlist -->
      <section class="book-section">
         <h2>üìå Wishlist: <%= @wishlist_books.count %></h2>
         <div class="scroll-box">
            <% if @wishlist_books.any? %>
               <% @wishlist_books.each do |book| %>
                  <%= render 'book_card', book: book, section_prefix: 'wishlist' %>
               <% end %>
            <% else %>
               <p>Your wishlist is empty!</p>
            <% end %>
         </div>
      </section>

		<section class="book-section">
			<h2> Favorites: <%= @favorite_books.count %> </h2>
			<div class="scroll-box">
				<% if @favorite_books.any? %>
					<% @favorite_books.each do |book| %>
						<%= render 'book_card', book: book, section_prefix: 'favorites'%>
					<% end %>
				<% else %>
					<p> NONE </p>
				<% end %>
			</div>
		</section>

      <!-- All Books -->
      <section class="book-section">
         <h1>All Books: <%= @books.count %></h1>
         <div class="scroll-box">
            <% if @books.any? %>
               <% @books.each do |book| %>
                  <%= render 'book_card', book: book, section_prefix: 'all-books' %>
               <% end %>
            <% else %>
               <p>You do not have any books...</p>
            <% end %>
         </div>
      </section>
   </div>
<% else %>
   <p>Sign in to track your reading progress!</p>
<% end %>